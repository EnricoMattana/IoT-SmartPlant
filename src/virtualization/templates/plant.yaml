schemas:
  common_fields:
    _id: str
    type: str
    profile:
      name: str
      owner_id: str
      description: str
      outdoor: bool
      location: str
      auto_watering: bool
    metadata:
      created_at: datetime
      updated_at: datetime
      status: str
      last_warning_ts: str
      auto_watering_status: Dict

  entity:
    data:
      measurements: List[Dict]

  validations:
    mandatory_fields:
      root:
        - _id
        - type
      profile:
        - name
        - owner_id
        - outdoor
        - location
        - auto_watering
      metadata:
        - created_at
        - updated_at
    type_constraints:
      _id:
        type: str
      type:
        type: str

      profile:
        name:
          type: str
        owner_id:
          type: str
        description:
          type: str
        location:
          type: str
        outdoor:
          type: bool
        auto_watering:
          type: bool

      metadata:
        created_at:
          type: datetime
        updated_at:
          type: datetime
        status:
          type: str
        last_warning_ts:
          type: datetime
        auto_watering_status:
          type: Dict
          item_constraints:
            required_fields: ["last_block", "last_water", "consec_failed", "consec_water"]
            type_mappings:
              last_block: str
              last_water: datetime
              consec_failed: int
              consec_water: int

      data:
        measurements:
          type: List[Dict]
          item_constraints:
            required_fields: ["type", "value", "timestamp"]
            type_mappings:
              type: str
              value: float
              timestamp: datetime

    initialization:
      metadata:
        status: "active"
        last_warning_ts: null
        auto_watering_status:
          last_block: null
          last_water: null
          consec_failed: 0
          consec_water: 0
      data:
        measurements: []
